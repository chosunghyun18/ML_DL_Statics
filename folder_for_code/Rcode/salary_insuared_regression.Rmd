---
title: "월수입과 보험가입 사이의 회귀분석"
author: "201803430 조성현"
date: "6/11/2021"
output: html_document
---

##### 문제)

다음은 월수입과 보험 가입금액과의 관계를 알아보기 위해 조사에서 얻은 데이터의 일부이다. R을 이용하여 다음에 답하시오. 

(단위 : 월 수입-만원, 보험가입금액-천만원)


|||||||||||||||
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|월 수입 (만원)|	160	|55|	80|	60|	85|	77|	100|	63|	45|	50|72|60|150|
|보험가입금액 (천만원)|	20|	3.5|	3.5|	5|	10|	6.5|	3|	2.5|	1.5|	2|	2|	2.5|	15|
|||||||||||||||



```{r,echo = F}
#make a data set,
#월수입(monthly income:mi) 보험 가입 금액(insured amount :ia)
mi <-c(160,55,80,60,85,77,100,63,45,50,72,60,150)
# 주어진 자료 보험 가입 금액(천만원)  insured amount given data = iag
iag  <- c(20,3.5,3.5,5,10,6.5,3,2.5,1.5,2,2,2.5,15)

# 보험 가입 금액(insuared amount/ia) (단위 만원) 
ia<-c()

#보험 가입 금액과 월수입의 단위가 달라 보험가입 금액x1000 을 해준 후 변수 ia 에 저장 
for (i in iag)
{
   ia<-append(ia,i*1000)
}

money= data.frame(mi,ia)
money
```

##### 1.	
산점도를 그리고, 표본상관계수를 추정하고 상관관계가 존재하는지 유의수준 1% 하에서 검정하시오. 

```{r,echo = F}
#make scatter plot
plot(x=mi,y=ia,xlab='monthly income',ylab='insuared amount')          
```


귀무 가설(H0): 월 수입과 보험 가입 금액 간의 상관 관계가 없다.


```{r,echo =F}
#correlationtest with a pearson method
cor(mi,ia)
cor.test(mi,ia,method ="pearson")
```




통계 결과)

통계량 t =6.904

추정된 상관계수는 r= 0.901 이다.

유의 확률(p-value): 2.573e-05 은,유의 수준 1 % = 0.01 보다 작다,
 
 그렇므로 귀무 가설을 기각한다.
 
 따라서 월 수입과 보험 가입 금액간 양의 상관관계가 있다 라고 할 수 있다.

 


##### 2.	

분산분석표를 작성하고 추정된 회귀직선이 유의한지 유의수준 5% 하에서 검정하시오

귀무 가설 : 회귀 추정식이 유의 하지 않으며, 추정된 자료에서 멀다.

2-1.분산분석표
```{r,echo=F}
mod = aov(ia~mi,data=money)
summary(mod)
```
통계 결과)

 유의확률이  Pr(>F) :2.57e-05 이므로 유의수준 5%인 0.05 보다 작다
 
 
2-2.회귀 직선 추정 

```{r,echo = F}
form = as.formula(ia ~ mi)
mod1 <- lm(form,data=money)
summary(mod1)
# y = -5695.6 + 142.9x
#Adjusted-R squared: 0.796
```

통계결과)

 유의확률이 p-value:2.57e-05 이므로 유의수준 5%인 0.05 보다 작다
 
 그렇므로 귀무 가설을 기각한다.

결론 

 따라서 회귀 추정식이 유의하며, 추정된 자료에 멀지 않다 라고 할 수있다.
 
 
##### 3.	
결정계수를 구하고 그 의미를 설명하시오. 
```{r,echo=F,results='hide'}
mod <- lm(money$ia ~ money$mi)
summary(mod)
```

결정 계수 ( R squared/coefficient determination ):


0 ~ 1 사이의 값을 가지며 1에가까울 수록 회귀식에 의한 설명력이 졸다고 한다.

통계 결과 Adjusted R-squared:  0.796

회귀분석을 통해 구한 결정계수는, "추정된 회귀식이 자료를 79.6% 설명한다" 라는 의미를 보여준다.



##### 4.	
회귀모형 추정식을 쓰고, 의미를 설명하시오.


추정식:
y = -5695.6 + 142.9x
(y=insured amount(보험가입금액 | 단위: 만원), x = monthly income(월 수입 | 단위 :만원))

월수입 x에따라서 회귀모형 추정식에 따라 보험 가입 금액 y를 유추 할 수있다. 이때 기울기는 양수 이므로 월급이 
증가함에 따라 추정식의 결과인 보험가입 금액도 선형적으로 증가한다라고 추정할 수 가있다. 


##### 5.
회귀모형에서 오차에 대한 가정을 쓰고, 자료가 회귀모형을 적용하기에 적절한지 설명하시오

가정)

오차= 잔차= 관측값-회귀식에서의 추정값

오차에 대한 가정으로 정규성 등분산성을 검정 한다.

```{r,echo=FALSE}

# 회귀분석에 사용한 모형 mod1(model1) ,form = as.formula(ia ~ mi)
#mod1 <- lm(form,data=money)

#잔차의 정규성 검정
shapiro.test(mod1$residuals)
```
잔차의 정규성 검정, 샤피로 검정을 이용한다. 유의 수준은 5%로 검정한다.

귀무 가설: 잔차는 정규성을 따른다.

유의 확률 p-value = 0.72 > 0.05 이므로 귀무 가설을 기각하지 않는다.

그렇므로 잔차의 등분산성과 정규성을 따른다는 가정할 수 있다.

```{r,echo=FALSE}
par(mfrow=c(2,2))
plot(mod1)
```


1번 그림좌측에 잔차가 선에따라모여 있는 것을 확인할 수있다. 


2번 그림(Q-Q plot)
잔차의 정규성을 만족 하는것을 보여준다


3번 그림 (표준화 잔차)
기울기가 0인 직선이 이상적

4번 그림
왼쪽 가운데 몰려있어야 이상적

오차 즉 잔차가 정규성과 등분산 성을 만족 하는것으로 보이므로, 자료가 회귀 모형에 적절 하다고 할 수 있다.



##### 6.
월 수입이 70만원일 때, 예상되는 보험가입금액을 구하시오. 
```{r}
#월 수입 70 만원을 추정한 회귀식에 대입한다
x = 70
y= -5695.6 + 142.9*x
print(y)
```


월 수입이 70만원일 때,예상되는 보험 가입 금액 : `r y` (단위: 만원)







